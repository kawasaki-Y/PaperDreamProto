# Paper Dream - ãƒã‚°ä¿®æ­£ (3ã¤ã®å•é¡Œ)

ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã«ä»¥ä¸‹ã®3ã¤ã®å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

---

## ä¿®æ­£1: ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—ã®ä¿®æ­£

### å•é¡Œ
ã‚«ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ç”»åƒã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã™ã‚‹ã¨å¤±æ•—ã™ã‚‹

### åŸå› ã®å¯èƒ½æ€§
1. ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰APIã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä¸è¶³
2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™
3. CORSè¨­å®šã®å•é¡Œ
4. ãƒ‘ã‚¹ã®å•é¡Œ

### ä¿®æ­£å†…å®¹

#### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰APIã®å¼·åŒ–
`app/api/upload/route.ts`
```typescript
import { NextResponse } from 'next/server'
import { writeFile, mkdir } from 'fs/promises'
import { join } from 'path'
import { existsSync } from 'fs'

export async function POST(request: Request) {
  try {
    const formData = await request.formData()
    const file = formData.get('file') as File
    
    if (!file) {
      return NextResponse.json(
        { error: 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“' }, 
        { status: 400 }
      )
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯ (10MBåˆ¶é™)
    const maxSize = 10 * 1024 * 1024 // 10MB
    if (file.size > maxSize) {
      return NextResponse.json(
        { error: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™ (æœ€å¤§10MB)' }, 
        { status: 400 }
      )
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯
    const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp']
    if (!allowedTypes.includes(file.type)) {
      return NextResponse.json(
        { error: 'å¯¾å¿œã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™ (JPEG, PNG, GIF, WebPã®ã¿)' }, 
        { status: 400 }
      )
    }
    
    const bytes = await file.arrayBuffer()
    const buffer = Buffer.from(bytes)
    
    // uploadsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
    const uploadDir = join(process.cwd(), 'public', 'uploads')
    if (!existsSync(uploadDir)) {
      await mkdir(uploadDir, { recursive: true })
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆ (ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— + ãƒ©ãƒ³ãƒ€ãƒ æ–‡å­—åˆ—)
    const timestamp = Date.now()
    const randomStr = Math.random().toString(36).substring(7)
    const ext = file.name.split('.').pop()
    const filename = `${timestamp}-${randomStr}.${ext}`
    
    const filepath = join(uploadDir, filename)
    await writeFile(filepath, buffer)
    
    // URLã‚’è¿”ã™
    const imageUrl = `/uploads/${filename}`
    
    console.log('âœ… ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ:', imageUrl)
    
    return NextResponse.json({ 
      success: true,
      imageUrl,
      filename,
      size: file.size,
      type: file.type
    })
    
  } catch (error) {
    console.error('âŒ ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error)
    return NextResponse.json(
      { 
        error: 'ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ',
        details: error instanceof Error ? error.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'
      }, 
      { status: 500 }
    )
  }
}

// GET: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ç”»åƒä¸€è¦§ã‚’å–å¾—
export async function GET() {
  try {
    const uploadDir = join(process.cwd(), 'public', 'uploads')
    if (!existsSync(uploadDir)) {
      return NextResponse.json({ images: [] })
    }
    
    const { readdir } = await import('fs/promises')
    const files = await readdir(uploadDir)
    const images = files
      .filter(file => /\.(jpg|jpeg|png|gif|webp)$/i.test(file))
      .map(file => `/uploads/${file}`)
    
    return NextResponse.json({ images })
  } catch (error) {
    return NextResponse.json({ error: 'ç”»åƒä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ' }, { status: 500 })
  }
}
```

#### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
```typescript
const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
  const file = e.target.files?.[0]
  if (!file) return
  
  // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é–‹å§‹
  setIsUploading(true)
  
  try {
    const formData = new FormData()
    formData.append('file', file)
    
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData,
    })
    
    const data = await response.json()
    
    if (!response.ok) {
      throw new Error(data.error || 'ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ')
    }
    
    console.log('âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ:', data.imageUrl)
    
    // ç”»åƒURLã‚’è¨­å®š
    if (viewSide === 'front') {
      setFrontImageUrl(data.imageUrl)
    } else {
      setBackImageUrl(data.imageUrl)
    }
    
    // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
    alert('ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ!')
    
  } catch (error) {
    console.error('âŒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ©ãƒ¼:', error)
    alert(error instanceof Error ? error.message : 'ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ')
  } finally {
    setIsUploading(false)
  }
}

// ç›´æ¥ç·¨é›†ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ã®ç”»åƒã‚¯ãƒªãƒƒã‚¯å‡¦ç†
const handleImageClick = () => {
  const input = document.createElement('input')
  input.type = 'file'
  input.accept = 'image/*'
  input.onchange = async (e) => {
    const target = e.target as HTMLInputElement
    const file = target.files?.[0]
    if (!file) return
    
    setIsUploading(true)
    
    try {
      const formData = new FormData()
      formData.append('file', file)
      
      const response = await fetch('/api/upload', {
        method: 'POST',
        body: formData,
      })
      
      const data = await response.json()
      
      if (!response.ok) {
        throw new Error(data.error)
      }
      
      // ç”»åƒURLã‚’è¨­å®š
      updateCardData({ 
        [viewSide === 'front' ? 'frontImageUrl' : 'backImageUrl']: data.imageUrl 
      })
      
    } catch (error) {
      alert(error instanceof Error ? error.message : 'ç”»åƒã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸ')
    } finally {
      setIsUploading(false)
    }
  }
  input.click()
}
```

---

## ä¿®æ­£2: ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ãƒ•ãƒƒã‚¿ãƒ¼ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«

### ç¾çŠ¶
- èƒŒæ™¯è‰²ãƒ»ãƒ†ã‚­ã‚¹ãƒˆè‰²ãƒ»ãƒ•ã‚©ãƒ³ãƒˆãƒ»ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚ºã®ã¿å¤‰æ›´å¯èƒ½
- ãƒ˜ãƒƒãƒ€ãƒ¼(ã‚«ãƒ¼ãƒ‰åã‚¨ãƒªã‚¢)ã¨ãƒ•ãƒƒã‚¿ãƒ¼(PARTY CARDã‚¨ãƒªã‚¢)ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãŒå›ºå®š

### ä¿®æ­£å¾Œ
ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´ã«ä»¥ä¸‹ã‚’è¿½åŠ :
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆèª¿æ•´                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚ ã‚«ãƒ¼ãƒ‰å…¨ä½“                               â”‚
â”‚ - ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚º: [æ¥µå°][å°][ä¸­][å¤§]     â”‚
â”‚ - èƒŒæ™¯è‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]               â”‚
â”‚ - ãƒ†ã‚­ã‚¹ãƒˆè‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]           â”‚
â”‚ - ãƒ•ã‚©ãƒ³ãƒˆ: [ã‚´ã‚·ãƒƒã‚¯][æ˜æœ][ä¸¸][æ‰‹æ›¸ã] â”‚
â”‚                                         â”‚
â”‚ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¨ãƒªã‚¢(ã‚«ãƒ¼ãƒ‰å)                 â”‚
â”‚ - èƒŒæ™¯è‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]               â”‚
â”‚ - ãƒ†ã‚­ã‚¹ãƒˆè‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]           â”‚
â”‚ - è§’ä¸¸: [ãªã—][å°][ä¸­][å¤§]               â”‚
â”‚                                         â”‚
â”‚ ãƒ•ãƒƒã‚¿ãƒ¼ã‚¨ãƒªã‚¢(PARTY CARD)               â”‚
â”‚ - èƒŒæ™¯è‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]               â”‚
â”‚ - ãƒ†ã‚­ã‚¹ãƒˆè‰²: [ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼]           â”‚
â”‚ - è¡¨ç¤º/éè¡¨ç¤º: [âœ“ è¡¨ç¤ºã™ã‚‹]             â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DBè¨­è¨ˆ(attributesã®layoutã«è¿½åŠ )
```json
{
  "layout": {
    // æ—¢å­˜
    "textSize": "medium",
    "backgroundColor": "#2563eb",
    "fontFamily": "gothic",
    "textColor": "#ffffff",
    
    // æ–°è¦è¿½åŠ 
    "header": {
      "backgroundColor": "#1e40af",  // ãƒ˜ãƒƒãƒ€ãƒ¼èƒŒæ™¯è‰²
      "textColor": "#ffffff",         // ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆè‰²
      "borderRadius": "medium"        // è§’ä¸¸ "none" | "small" | "medium" | "large"
    },
    "footer": {
      "backgroundColor": "#1e3a8a",  // ãƒ•ãƒƒã‚¿ãƒ¼èƒŒæ™¯è‰²
      "textColor": "#ffffff",         // ãƒ•ãƒƒã‚¿ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆè‰²
      "visible": true                 // è¡¨ç¤º/éè¡¨ç¤º
    }
  }
}
```

### å®Ÿè£…
```typescript
// ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®šState
const [layout, setLayout] = useState({
  textSize: 'medium',
  backgroundColor: '#2563eb',
  fontFamily: 'gothic',
  textColor: '#ffffff',
  header: {
    backgroundColor: '#1e40af',
    textColor: '#ffffff',
    borderRadius: 'medium',
  },
  footer: {
    backgroundColor: '#1e3a8a',
    textColor: '#ffffff',
    visible: true,
  },
})

// ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®šUI
<div className="space-y-2">
  <h4 className="font-semibold">ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¨ãƒªã‚¢(ã‚«ãƒ¼ãƒ‰å)</h4>
  
  <div>
    <label className="text-sm">èƒŒæ™¯è‰²</label>
    <input
      type="color"
      value={layout.header.backgroundColor}
      onChange={(e) => setLayout({
        ...layout,
        header: { ...layout.header, backgroundColor: e.target.value }
      })}
      className="w-full h-10 rounded cursor-pointer"
    />
  </div>
  
  <div>
    <label className="text-sm">ãƒ†ã‚­ã‚¹ãƒˆè‰²</label>
    <input
      type="color"
      value={layout.header.textColor}
      onChange={(e) => setLayout({
        ...layout,
        header: { ...layout.header, textColor: e.target.value }
      })}
      className="w-full h-10 rounded cursor-pointer"
    />
  </div>
  
  <div>
    <label className="text-sm">è§’ä¸¸</label>
    <div className="flex gap-2">
      {['none', 'small', 'medium', 'large'].map(radius => (
        <button
          key={radius}
          onClick={() => setLayout({
            ...layout,
            header: { ...layout.header, borderRadius: radius }
          })}
          className={`px-3 py-1 rounded ${
            layout.header.borderRadius === radius 
              ? 'bg-blue-600 text-white' 
              : 'bg-gray-200'
          }`}
        >
          {radius === 'none' ? 'ãªã—' : radius === 'small' ? 'å°' : radius === 'medium' ? 'ä¸­' : 'å¤§'}
        </button>
      ))}
    </div>
  </div>
</div>

// ãƒ•ãƒƒã‚¿ãƒ¼è¨­å®šUI
<div className="space-y-2">
  <h4 className="font-semibold">ãƒ•ãƒƒã‚¿ãƒ¼ã‚¨ãƒªã‚¢(PARTY CARD)</h4>
  
  <div className="flex items-center gap-2">
    <input
      type="checkbox"
      checked={layout.footer.visible}
      onChange={(e) => setLayout({
        ...layout,
        footer: { ...layout.footer, visible: e.target.checked }
      })}
      className="w-4 h-4"
    />
    <label className="text-sm">è¡¨ç¤ºã™ã‚‹</label>
  </div>
  
  {layout.footer.visible && (
    <>
      <div>
        <label className="text-sm">èƒŒæ™¯è‰²</label>
        <input
          type="color"
          value={layout.footer.backgroundColor}
          onChange={(e) => setLayout({
            ...layout,
            footer: { ...layout.footer, backgroundColor: e.target.value }
          })}
          className="w-full h-10 rounded cursor-pointer"
        />
      </div>
      
      <div>
        <label className="text-sm">ãƒ†ã‚­ã‚¹ãƒˆè‰²</label>
        <input
          type="color"
          value={layout.footer.textColor}
          onChange={(e) => setLayout({
            ...layout,
            footer: { ...layout.footer, textColor: e.target.value }
          })}
          className="w-full h-10 rounded cursor-pointer"
        />
      </div>
    </>
  )}
</div>

// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«åæ˜ 
const getBorderRadius = (size: string) => {
  const radiusMap = {
    none: '0',
    small: '4px',
    medium: '8px',
    large: '16px',
  }
  return radiusMap[size] || radiusMap.medium
}

// ã‚«ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ˜ãƒƒãƒ€ãƒ¼
<div 
  className="mb-2 p-2"
  style={{
    backgroundColor: layout.header.backgroundColor,
    color: layout.header.textColor,
    borderRadius: getBorderRadius(layout.header.borderRadius),
  }}
>
  <h3 className="font-bold text-center" style={{ fontSize: textSizes.title }}>
    {cardName || 'ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚«ãƒ¼ãƒ‰åã‚’ç·¨é›†'}
  </h3>
</div>

// ã‚«ãƒ¼ãƒ‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ãƒ•ãƒƒã‚¿ãƒ¼
{layout.footer.visible && (
  <div 
    className="text-center text-xs mt-2 p-2 rounded"
    style={{
      backgroundColor: layout.footer.backgroundColor,
      color: layout.footer.textColor,
    }}
  >
    PARTY CARD
  </div>
)}
```

---

## ä¿®æ­£3: å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’åæ˜ ã€æœ€é‡è¦ã€‘

### å•é¡Œ
ä¿å­˜ã—ãŸã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š(èƒŒæ™¯è‰²ãƒ»ãƒ•ã‚©ãƒ³ãƒˆãƒ»ãƒ†ã‚­ã‚¹ãƒˆã‚µã‚¤ã‚ºç­‰)ãŒå°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã«åæ˜ ã•ã‚Œãªã„

### åŸå› 
å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€éš›ã€`attributes.layout` ã‚’ç„¡è¦–ã—ã¦ã„ã‚‹

### ä¿®æ­£å†…å®¹

#### ã‚«ãƒ¼ãƒ‰ä¿å­˜æ™‚ã«layoutã‚’attributesã«å«ã‚ã‚‹
```typescript
const saveCard = async () => {
  const attributes = {
    // ãƒ‘ãƒ¼ãƒ†ã‚£ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ å›ºæœ‰ã®æƒ…å ±
    type: selectedCardType,
    category: cardCategory,
    action: actionContent,
    effect: effectDescription,
    winCondition: winCondition,
    players: playerCount,
    difficulty: selectedDifficulty,
    
    // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š(é‡è¦!)
    layout: layout,
  }
  
  const response = await fetch('/api/cards', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      gameId: currentGameId,
      name: cardName,
      description: effectDescription,
      frontImageUrl: frontImageUrl || null,
      backImageUrl: backImageUrl || null,
      attributes: attributes,
    }),
  })
  
  // ...
}
```

#### å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»é¢ã§layoutã‚’èª­ã¿è¾¼ã‚“ã§é©ç”¨
`app/print-preview/page.tsx` (ã¾ãŸã¯è©²å½“ãƒšãƒ¼ã‚¸)
```typescript
'use client'

import { useEffect, useState } from 'react'
import { useSearchParams } from 'next/navigation'

export default function PrintPreviewPage() {
  const searchParams = useSearchParams()
  const gameId = searchParams.get('gameId')
  
  const [cards, setCards] = useState([])
  const [selectedCards, setSelectedCards] = useState<string[]>([])
  
  useEffect(() => {
    if (gameId) {
      loadCards(gameId)
    }
  }, [gameId])
  
  const loadCards = async (gameId: string) => {
    const response = await fetch(`/api/cards?gameId=${gameId}`)
    const data = await response.json()
    
    // ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæƒ…å ±ã‚’å«ã‚ã¦è§£æ
    const parsedCards = data.map((card: any) => ({
      id: card.id,
      name: card.name,
      frontImageUrl: card.frontImageUrl,
      backImageUrl: card.backImageUrl,
      attributes: card.attributes,
      // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæƒ…å ±ã‚’æŠ½å‡º(é‡è¦!)
      layout: card.attributes?.layout || getDefaultLayout(),
    }))
    
    setCards(parsedCards)
    console.log('ğŸ“„ èª­ã¿è¾¼ã‚“ã ã‚«ãƒ¼ãƒ‰:', parsedCards)
  }
  
  const getDefaultLayout = () => ({
    textSize: 'medium',
    backgroundColor: '#2563eb',
    fontFamily: 'gothic',
    textColor: '#ffffff',
    header: {
      backgroundColor: '#1e40af',
      textColor: '#ffffff',
      borderRadius: 'medium',
    },
    footer: {
      backgroundColor: '#1e3a8a',
      textColor: '#ffffff',
      visible: true,
    },
  })
  
  return (
    <div>
      <h1>å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h1>
      
      <div className="grid grid-cols-3 gap-4">
        {cards.map((card: any) => (
          <PrintableCard 
            key={card.id}
            card={card}
            layout={card.layout} // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’æ¸¡ã™(é‡è¦!)
            isSelected={selectedCards.includes(card.id)}
            onSelect={() => toggleCardSelection(card.id)}
          />
        ))}
      </div>
    </div>
  )
}

// å°åˆ·ç”¨ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const PrintableCard = ({ card, layout, isSelected, onSelect }) => {
  return (
    <div 
      className="cursor-pointer border-2 rounded-lg overflow-hidden"
      style={{
        borderColor: isSelected ? '#2563eb' : '#e5e7eb',
      }}
      onClick={onSelect}
    >
      <div 
        className="aspect-[63/88] p-4"
        style={{
          backgroundColor: layout.backgroundColor,
          color: layout.textColor,
          fontFamily: getFontFamily(layout.fontFamily),
        }}
      >
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <div 
          className="mb-2 p-2"
          style={{
            backgroundColor: layout.header.backgroundColor,
            color: layout.header.textColor,
            borderRadius: getBorderRadius(layout.header.borderRadius),
          }}
        >
          <h3 className="font-bold text-center" style={{ fontSize: getTextSize(layout.textSize).title }}>
            {card.name}
          </h3>
        </div>
        
        {/* ç”»åƒ */}
        {card.frontImageUrl && (
          <img 
            src={card.frontImageUrl} 
            alt={card.name}
            className="w-full object-cover rounded mb-2"
          />
        )}
        
        {/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
        <div style={{ fontSize: getTextSize(layout.textSize).body }}>
          <div className="mb-1">
            <div className="font-semibold">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
            <div>{card.attributes?.action}</div>
          </div>
          <div>
            <div className="font-semibold">åŠ¹æœ</div>
            <div>{card.attributes?.effect}</div>
          </div>
        </div>
        
        {/* ãƒ•ãƒƒã‚¿ãƒ¼ */}
        {layout.footer.visible && (
          <div 
            className="text-center text-xs mt-2 p-1 rounded"
            style={{
              backgroundColor: layout.footer.backgroundColor,
              color: layout.footer.textColor,
            }}
          >
            PARTY CARD
          </div>
        )}
      </div>
    </div>
  )
}
```

---

## å®Ÿè£…å„ªå…ˆé †ä½

1. **ä¿®æ­£3: å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¸ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåæ˜ ** (30åˆ†) â† **æœ€é‡è¦**
2. **ä¿®æ­£1: ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¿®æ­£** (20åˆ†)
3. **ä¿®æ­£2: ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»ãƒ•ãƒƒã‚¿ãƒ¼ãƒ‡ã‚¶ã‚¤ãƒ³** (30åˆ†)

**åˆè¨ˆ: 1æ™‚é–“20åˆ†**

---

ã“ã®3ã¤ã®ä¿®æ­£ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
ç‰¹ã«ã€Œä¿®æ­£3: å°åˆ·ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¸ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåæ˜ ã€ã¯**æœ€å„ªå…ˆ**ã§å¯¾å¿œã—ã¦ãã ã•ã„ã€‚

å®Ÿè£…å®Œäº†ã—ãŸã‚‰ã€å‹•ä½œç¢ºèªã—ã¾ã™ã€‚